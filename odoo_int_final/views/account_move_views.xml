<odoo>

   <!-- Action to open account.move.line.tax (Tax Lines for invoice lines) -->
    <record id="action_open_move_line_tax" model="ir.actions.act_window">
        <field name="name">Move Line Tax Lines</field>
        <field name="res_model">account.move.line.tax</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('move_line_id', '=', context.get('default_move_line_id'))]</field>
    </record>
    

    <!-- View Inherit -->
    <record id="view_move_form_inherit_custom" model="ir.ui.view">
        <field name="name">account.move.form.invoice.custom</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">

            <!-- Add buttons inside header -->
            <xpath expr="//header" position="inside">
                <button name="action_ceretax_calculate"
                        string="Calc Tax"
                        type="object"/>
                <button name="action_ceretax_validate_so_address"
                        string="Validate Address"
                        type="object"
                        class="btn-secondary"/>
            </xpath>

            <!-- Remove original tax_ids field from list -->
            <xpath expr="//field[@name='invoice_line_ids']//list//field[@name='tax_ids']"
                   position="replace"/>

            <!-- Add CereTax tax and Tax Details button after quantity -->
            <xpath expr="//field[@name='invoice_line_ids']//list//field[@name='price_unit']"
                   position="after">

                <field name="ceretax_line_tax" string="Tax"/>

                <button name="%(action_open_move_line_tax)d"
                        type="action"
                        icon="fa-list"
                        string="Tax Details"
                        context="{'default_move_line_id': id}"
                        domain="[('move_line_id', '=', id)]"/>
            </xpath>

            <!-- Address validation note -->
            <xpath expr="//sheet" position="after">
                <group string="Validate Address">
                    <field name="ceretax_last_address_validation"
                           readonly="1"/>
                      <span class="o_form_label" style="font-weight:bold; font-size:16px; color:#333;">
                Integration partner LnS Infusion
            </span>
                </group>
            </xpath>

        </field>
    </record>

</odoo>
